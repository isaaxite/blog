## 前言
**旧博客迁移，[\[原链接\]](https://www.jianshu.com/p/5166843ca015)**

## 正文

- 缺点：
使用外部字体，英文还好，只有26个字母，所以字体文件也不大（一个顶多就几百k），但是现在浏览器很多，字体文件也不是通用，所以要兼容大部分浏览器就需要好几个字体文件。但是使用中文字体文件的话就问题大了，中文字体库，大概有9万个汉字（少也有2到3万），一个字体文件就几m了，还要兼容，那么就是几十m。

- 渲染动态数据还是不要使用第三方字体：
若要想用外部文件适配所有的中文字体（对于动态数据，汉字不是固定的），就不要使用外部字体文件，会很大大降低网页加载速度，有多慢？我试过就只加载个字体文件就4s，总用时9s多，如果用字体文件做字体图标倒是可以使用，这也是值得提倡，这样的话连精灵图都不用，减少请求数。

- 折中优化
 1. 非要使用的话，优化的办法是：使用cdn（但是也是优化不大，可以说是没有用）；
 2. 对于动态数据（未知数据），不使用第三方字体渲染，而改用系统字体，只对已知数据使用第三方字体渲染，然后将字体文件中不使用的文字全部删除，达到极大压缩字体文件的效果（10m压缩成几十k[手动滑稽]）
```
font-family: 'slHeiTi','Microsoft Yahei','arial','Arial Narrow','HELVETICA','Tahoma';
// 第一个是第三方字体
```
###### 压缩字体的工具：“字蛛“
0）“字蛛“的原理
字蛛通过分析本地 CSS 与 HTML 文件获取 WebFont 中没有使用的字符，并将这些字符数据从字体中删除以实现压缩，并生成跨浏览器使用的格式。
官网：http://font-spider.org/#use
1）字蛛安装
```
//需要node环境，没有node环境，先去安装
npm install -g font-spider  //全局安装
//可以不-g安装，而是直接安装在你的项目下
```
2）构建文件，为压缩做准备
>贴一下项目结构：
>![Paste_Image.png](http://upload-images.jianshu.io/upload_images/2838289-54de5186ddb79f58.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
>PS:不是一定要php文件
新建个css文件，在里面用@font引入字体文件：
```
@font-face {
  font-family: 'KhmerUI';
  src: url('./fonts/khmer_ui/khmerui-0.eot');
  src: url('./fonts/khmer_ui/khmerui-0.eot?#iefix') format('embedded-opentype'), 
       url('./fonts/khmer_ui/khmerui-0.woff') format('woff'), 
       url('./fonts/khmer_ui/khmerui-0.ttf') format('truetype'),
       url('./fonts/khmer_ui/khmerui-0.svg#svgFontName') format('svg');
}
@font-face {
  font-family: 'slHeiTi';
  src: url('./fonts/slHeiTi/SourceHanSansCN-Regular.eot');
  src: url('./fonts/slHeiTi/SourceHanSansCN-Regular.eot?#iefix') format('embedded-opentype'),
       url('./fonts/slHeiTi/SourceHanSansCN-Regular.woff') format('woff'), 
       url('./fonts/slHeiTi/SourceHanSansCN-Regular.ttf') format('truetype'),
       url('./fonts/slHeiTi/SourceHanSansCN-Regular.svg#svgFontName') format('svg');  
}
h1{ font-family: 'KhmerUI'; }
div{ font-family: 'slHeiTi'; }
```
然后就是在html/php/jsp/ejs/while(1){“..."}/文件中引入(link)以上的css文件。
PS：我的项目是做了国际化的，文字都是放在数组里面，所以，分析html文件是分析不到我需要的字体的，我需要的字体都在语言包里面，所以我直接新建一个项目分析语言包的字体。如果没有做类似我这样的国际化，可以直接省略这一步。

    3）压缩字体文件：
    ```
font-spider ./demo/*.html  //你项目的路径
//比如，我的项目：
//font-spider ~/workspace/php/font/*.php
```

