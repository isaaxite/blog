---
title: æµè§ˆå™¨æ‰©å±•ç¨‹åº
date: 2023-06-08 10:18:55
tags:
---


# æ¦‚è§ˆ

<!-- è¿™ç¯‡æ–‡ç« ä»‹ç»äº†ä»€ä¹ˆï¼Ÿ -->

# æµè§ˆå™¨æ‰©å±•æ˜¯ä»€ä¹ˆï¼Ÿ

æµè§ˆå™¨æ‰©å±•æ˜¯ä¸€ç§è½¯ä»¶æ¨¡å—ï¼Œå¯ä¸ºWebæµè§ˆå™¨æ·»åŠ åŠŸèƒ½ã€‚å®ƒé€šå¸¸æ˜¯ç”¨HTMLã€CSSå’ŒJavaScriptç¼–å†™çš„ï¼Œå¯ä»¥åœ¨Webæµè§ˆå™¨ä¸­å®‰è£…å’Œè¿è¡Œï¼Œä»¥ä¿®æ”¹æµè§ˆå™¨çš„è¡Œä¸ºæˆ–æä¾›å…¶ä»–åŠŸèƒ½ã€‚

æµè§ˆå™¨æ‰©å±•å¯ç”¨äºè‡ªå®šä¹‰ç½‘é¡µå¤–è§‚ã€é˜»æ­¢å¹¿å‘Šã€ç®¡ç†å¯†ç ã€ä¸‹è½½æ–‡ä»¶ã€å¢å¼ºéšç§å’Œå®‰å…¨æ€§ç­‰è®¸å¤šä»»åŠ¡ã€‚å®ƒä»¬é€‚ç”¨äºæµè¡Œçš„Webæµè§ˆå™¨ï¼Œå¦‚Google Chromeã€Mozilla Firefoxã€Safariå’ŒMicrosoft Edgeï¼Œå¹¶å¯ä»¥ä»æµè§ˆå™¨çš„æ‰©å±•å•†åº—æˆ–ç¬¬ä¸‰æ–¹ç½‘ç«™ä¸‹è½½å’Œå®‰è£…ã€‚

ä»»ä½•å…·æœ‰åŸºæœ¬Webå¼€å‘æŠ€èƒ½çš„äººéƒ½å¯ä»¥å¼€å‘æµè§ˆå™¨æ‰©å±•ï¼Œè€Œä¸”æœ‰è®¸å¤šåœ¨çº¿èµ„æºå¯ä¾›å­¦ä¹ å¦‚ä½•åˆ›å»ºå®ƒä»¬ã€‚ä½†æ˜¯ï¼Œåœ¨ä»ç¬¬ä¸‰æ–¹æ¥æºå®‰è£…æ‰©å±•æ—¶ï¼Œéœ€è¦è°¨æ…ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½åŒ…å«æ¶æ„ä»£ç ï¼Œä¼šå±åŠæ‚¨çš„æµè§ˆå™¨å’Œè®¡ç®—æœºçš„å®‰å…¨ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›æœ€å—æ¬¢è¿çš„Webæµè§ˆå™¨çš„æ‰©å±•å•†åº—ï¼š

ğŸ”— Chrome Webå•†åº—ï¼šhttps://chrome.google.com/webstore

ğŸ”— Mozilla Add-onsï¼šhttps://addons.mozilla.org/

ğŸ”— Safariæ‰©å±•ç¨‹åºåº“ï¼šhttps://extensions.apple.com/

ğŸ”— Microsoft Edge Add-onsï¼šhttps://microsoftedge.microsoft.com/addons

# å¦‚ä½•å®‰è£…ï¼Ÿ

è¦ä½¿ç”¨å®˜æ–¹æ–¹å¼å®‰è£…æµè§ˆå™¨æ‰©å±•ç¨‹åºï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

1ï¸âƒ£ æ‰“å¼€æµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Safariæˆ–Edgeï¼‰ï¼›

2ï¸âƒ£ è¿›å…¥æµè§ˆå™¨æ‰©å±•å•†åº—ï¼ˆ[Chrome Webå•†åº—]ã€[Firefox å•†åº—]ã€[Mozilla Add-ons]ã€[Safariæ‰©å±•ç¨‹åºåº“]ã€[Microsoft Edge Add-ons]ï¼‰ï¼›

3ï¸âƒ£ æœç´¢ä½ è¦å®‰è£…çš„æ‰©å±•ç¨‹åºï¼›

4ï¸âƒ£ ç‚¹å‡»è¦å®‰è£…çš„æ‰©å±•ç¨‹åºï¼›

5ï¸âƒ£ ç‚¹å‡»â€œæ·»åŠ è‡³Chromeâ€ï¼ˆæˆ–â€œæ·»åŠ è‡³Firefoxâ€ã€â€œè·å–â€ï¼ˆSafariï¼‰æˆ–â€œè·å–â€ï¼ˆEdgeï¼‰ï¼‰æŒ‰é’®ï¼›

6ï¸âƒ£ æŸ¥çœ‹æ‰©å±•ç¨‹åºè¯·æ±‚çš„æƒé™ï¼Œå¹¶å•å‡»â€œæ·»åŠ æ‰©å±•ç¨‹åºâ€ï¼ˆæˆ–â€œæ·»åŠ è‡³Firefoxâ€ã€â€œå®‰è£…â€æˆ–â€œè·å–â€ï¼‰ï¼›

7ï¸âƒ£ æ‰©å±•ç¨‹åºç°åœ¨å·²å®‰è£…å¹¶æ·»åŠ åˆ°æµè§ˆå™¨å·¥å…·æ æˆ–èœå•ä¸­ã€‚ä½†å¯èƒ½éœ€è¦é‡æ–°å¯åŠ¨æµè§ˆå™¨ä»¥ä½¿æ‰©å±•ç¨‹åºå®Œå…¨å¯ç”¨ã€‚


**å¦‚æœæ‚¨æ— æ³•è®¿é—®æµè§ˆå™¨æ‰©å±•å•†åº—ï¼Œåˆ™æœ‰å‡ ç§æ›¿ä»£æ–¹æ³•å¯ä»¥ä¸‹è½½æµè§ˆå™¨æ‰©å±•ç¨‹åºï¼š**

ğŸ“Œ **ä»æ‰©å±•ç¨‹åºå¼€å‘äººå‘˜çš„ç½‘ç«™ä¸‹è½½**ï¼šè®¸å¤šæ‰©å±•ç¨‹åºå¼€å‘äººå‘˜åœ¨è‡ªå·±çš„ç½‘ç«™ä¸Šæ‰˜ç®¡æ‰©å±•ç¨‹åºæ–‡ä»¶ï¼Œä½ å¯ä»¥æ‰‹åŠ¨ä¸‹è½½å’Œå®‰è£…ï¼›

ğŸ“Œ **ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‰©å±•ç¨‹åºä¸‹è½½å™¨**ï¼šæœ‰å‡ ä¸ªç¬¬ä¸‰æ–¹ç½‘ç«™å…è®¸æ‚¨ä»Chrome Webå•†åº—ã€Mozilla Add-onså’Œå…¶ä»–æ‰©å±•ç¨‹åºå•†åº—ä¸‹è½½æµè§ˆå™¨æ‰©å±•ç¨‹åºã€‚æ¯”å¦‚ [CRX Extractor](http://crxextractor.com)ï¼Œå®ƒå¯ä»¥ä»Chrome Webå•†åº—æå–æ‰©å±•ç¨‹åºæ–‡ä»¶ï¼Œå¹¶å…è®¸ä½ æ‰‹åŠ¨å®‰è£…ã€‚

ğŸ“Œ **ä½¿ç”¨é¢„è£…æœ‰æ‰©å±•ç¨‹åºçš„ä¾¿æºå¼æµè§ˆå™¨**ï¼šæŸäº›ä¾¿æºå¼Webæµè§ˆå™¨ç‰ˆæœ¬é¢„è£…äº†æµè¡Œçš„æ‰©å±•ç¨‹åºï¼Œä½ å¯ä»¥åœ¨ä¸å®‰è£…æ‰©å±•ç¨‹åºçš„æƒ…å†µä¸‹ä½¿ç”¨å®ƒä»¬ã€‚

# å¦‚ä½•å¼€å‘æµè§ˆå™¨æ‰©å±•ï¼Ÿ


## æŠ€æœ¯æ ˆ

å¼€å‘ä¸€ä¸ª chrome æ‰©å±•ç¨‹åºéœ€è¦çš„æŠ€æœ¯æ ˆï¼šHTMLã€CSSã€JavaScript


## é¡¹ç›®ç»“æ„

```tree
.
â”œâ”€â”€ manifest.json
â”œâ”€â”€ background.js
â”œâ”€â”€ popup.html
â”œâ”€â”€ popup.js
â”œâ”€â”€ content_scripts/
â”‚   â”œâ”€â”€ content_script_1.js
â”‚   â”œâ”€â”€ content_script_2.js
â”‚   â””â”€â”€ styles/
â”‚       â”œâ”€â”€ style_1.css
â”‚       â””â”€â”€ style_2.css
â”œâ”€â”€ icons/
â”‚   â”œâ”€â”€ icon_16.png
â”‚   â”œâ”€â”€ icon_32.png
â”‚   â”œâ”€â”€ icon_48.png
â”‚   â””â”€â”€ icon_128.png
â”œâ”€â”€ options.html
â”œâ”€â”€ options.js
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ library_1.js
â”‚   â”œâ”€â”€ library_2.js
â”‚   â””â”€â”€ utility/
â”‚       â”œâ”€â”€ utility_1.js
â”‚       â””â”€â”€ utility_2.js
â””â”€â”€ README.md
```
å‚è€ƒï¼š[Architecture overview](https://developer.chrome.com/docs/extensions/mv3/architecture-overview/)

|![](./%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%A9%E5%B1%95%E7%A8%8B%E5%BA%8F/Snipaste_2023-06-08_19-25-08.png)|
|:--:|


mainfest.json æ˜¯ä¸€ä¸ªæ‰©å±•ç¨‹åºæœ€åŸºæœ¬ä¹Ÿæ˜¯å¿…é¡»çš„ï¼Œæœ€å°‘è¦æœ‰å®ƒã€‚å®ƒæ˜¯é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ•´ä¸ªé¡¹ç›®çš„ç»“æ„æ˜¯å›´ç»•å®ƒçš„é…ç½®é¡¹è¿›è¡Œç»„ç»‡ã€‚

ä½†æ˜¯ä¹Ÿä¸èƒ½åªæœ‰å®ƒï¼Œæ¯•ç«Ÿæ²¡æœ‰ä¸šåŠ¡é€»è¾‘çš„æ‰©å±•ç¨‹åºæ˜¯æ²¡æœ‰ä½œç”¨çš„ï¼

ä¸€ä¸ªæœ‰åŸºæœ¬é€»è¾‘çš„æ‰©å±•ç¨‹åºè‡³å°‘å¾—æœ‰ content_scriptsï¼Œè€Œå®Œæ•´çš„å®Œæ•´çš„æ‰©å±•ç¨‹åºåŒ…å« content_scriptsã€optionsã€popup å’Œ backgroundã€‚

**content_script**ï¼šjsè„šæœ¬ï¼Œå¯ä»¥ä¸æ‰©å±•ç¨‹åºåŒ¹é…åˆ°çš„é¡µé¢äº¤äº’å’Œæ“ä½œï¼›

**options**ï¼šæ‰©å±•ç¨‹åºçš„è®¾ç½®é¡µé¢ï¼Œæ‰©å±•ç¨‹åºæš´éœ²ç»™ç”¨æˆ·çš„è®¾ç½®é¡¹ä¸€èˆ¬æ”¾ç½®åœ¨è¿™ä¸ªé¡µé¢ï¼›

**popup**ï¼šæ‰©å±•ç¨‹åºçš„ä¿¡æ¯é¢æ¿ï¼Œåœ¨æµè§ˆå™¨å®‰è£…æ‰©å±•ç¨‹åºåï¼Œç”±ç‚¹å‡»å·¥å…·æ æ‰©å±•ç¨‹åºçš„å›¾æ ‡å‘¼èµ·çš„èœå•ï¼›

**background**ï¼šjsè„šæœ¬ï¼Œä½†æœ‰åˆ«äº content_scriptï¼Œå®ƒå¯ä»¥ä½¿ç”¨ Chrome apis ä»¥åŠ extension service workerã€‚å‰ä¸‰è€…éƒ½è¿è¡Œåœ¨è‡ªå·±çš„ä¸Šä¸‹æ–‡ï¼Œç›¸äº’é—´æ˜¯ç‹¬ç«‹ã€éš”ç¦»çš„ï¼Œè€Œ background åˆ™å¯ä»¥é€šè¿‡ extension service worker ä¸å®ƒä»¬ä¸‰è€…é€šä¿¡ï¼Œå¦‚ä¸Šå›¾ï¼Œbackground èµ·åˆ°ä¸‰ä¸ªæ¨¡å—é€šä¿¡æ¡¥æ¢çš„é‡è¦ä½œç”¨ï¼æ¯”åŒ…å«ä½†ä¸é™äºä»¥ä¸‹ä½œç”¨ï¼š

1ï¸âƒ£ åœ¨optionsé¡µé¢ï¼Œå¼€å…³æ‰©å±•ç¨‹åºæŸåŠŸèƒ½ï¼Œéœ€è¦é€šçŸ¥ content_script å¼€å…³å¯¹åº”åŠŸèƒ½ï¼›

2ï¸âƒ£ content_script æ‰§è¡Œæˆ–ä½¿ç”¨åŠŸèƒ½æ—¶éœ€è¦å°†ä¿¡æ¯å±•ç¤ºåœ¨ popup é¢æ¿ï¼›

3ï¸âƒ£ åœ¨ popup é¢æ¿ä¸´æ—¶ç¦ç”¨æ‰©å±•ç¨‹åºï¼Œpopupåˆ™éœ€è¦é€šçŸ¥ content_scriptã€‚



## Mainfest

`manifest.json` æ˜¯å¼€å‘æµè§ˆå™¨æ‰©å±•æ—¶å¿…å¤‡çš„æ¸…å•æ–‡ä»¶ï¼Œç”¨äºå®šä¹‰æ‰©å±•ç¨‹åºçš„åç§°ã€ç‰ˆæœ¬ã€å›¾æ ‡ã€æƒé™ã€åŠŸèƒ½ç­‰ä¿¡æ¯ã€‚

*å®ƒæ˜¯å¿…é¡»çš„é…ç½®æ–‡ä»¶ï¼Œéœ€è¦å°†å…¶å­˜æ”¾åœ¨æ‰©å±•ç¨‹åºçš„æ ¹ç›®å½•ä¸‹ï¼Œå³æ‰©å±•ç¨‹åºçš„æ–‡ä»¶å¤¹ä¸­ï¼*

ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„manifest.jsonç¤ºä¾‹ï¼š

```json
{
  "manifest_version": 3,
  "name": "My Extension",
  "version": "1.0",
  "description": "This is a simple extension",
  "action": {
    "default_title": "My Extension",
    "default_icon": {
      "16": "icons/icon16.png",
      "32": "icons/icon32.png",
      "48": "icons/icon48.png",
      "128": "icons/icon128.png"
    },
    "default_popup": "popup.html"
  }
}
```

è¿™ä¸ªç¤ºä¾‹ä¸­åŒ…å«äº†ä¸€äº›ç®€å•çš„é…ç½®ï¼š

name, version, description åˆ†åˆ«æŒ‡å®šäº†æ‰©å±•ç¨‹åºçš„åç§°ã€ç‰ˆæœ¬å·ã€æè¿°ã€‚
action æŒ‡å®šäº†æµè§ˆå™¨æ“ä½œæŒ‰é’®çš„é»˜è®¤å›¾æ ‡ã€æ ‡é¢˜å’Œå¼¹å‡ºçª—å£ã€‚
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªç¤ºä¾‹ä¸­æ²¡æœ‰åŒ…å«åå°è„šæœ¬ã€å†…å®¹è„šæœ¬ã€æƒé™ç­‰é…ç½®ï¼Œè¿™äº›é…ç½®æ ¹æ®å…·ä½“éœ€æ±‚å’ŒåŠŸèƒ½å¯ä»¥æ·»åŠ 

å®Œæ•´çš„ mainfest å±æ€§å®šä¹‰ä»¥åŠä¾‹å­å¯ä»¥æŸ¥é˜… [Manifest file format]


## Content Scripts


æ‰©å±•ç¨‹åºçš„ content script ä½œä¸ºæµè§ˆå™¨æ‰©å±•ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºä¸åŒ¹é…åˆ°çš„é¡µé¢äº¤äº’å’Œæ“ä½œã€‚å®ƒå¯ä»¥åœ¨åŒ¹é…åˆ°çš„é¡µé¢ä¸­æ³¨å…¥ JavaScript ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®é¡µé¢çš„ DOM å’Œ JavaScript å¯¹è±¡ã€‚

### ç‰¹æ€§

**ä¿®æ”¹é¡µé¢çš„å†…å®¹å’Œæ ·å¼**ï¼šcontent script å¯ä»¥ç›´æ¥æ“ä½œé¡µé¢çš„ DOM å’Œ CSS æ ·å¼ï¼Œå®ç°å¯¹é¡µé¢å†…å®¹å’Œæ ·å¼çš„ä¿®æ”¹ã€‚

**ç›‘å¬é¡µé¢äº‹ä»¶**ï¼šcontent script å¯ä»¥æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨ï¼Œç›‘å¬é¡µé¢çš„äº‹ä»¶ï¼Œä¾‹å¦‚ç‚¹å‡»ã€æ»šåŠ¨ã€è¾“å…¥ç­‰ï¼Œä»è€Œå®ç°ä¸é¡µé¢çš„äº¤äº’ã€‚

**ä¸æ‰©å±•ç¨‹åºé€šä¿¡**ï¼šcontent script å¯ä»¥é€šè¿‡ chrome.runtime.sendMessage()ã€chrome.runtime.onMessageã€chrome.runtime.connect()ã€chrome.runtime.onConnect ç­‰ subset API ä¸æ‰©å±•ç¨‹åºè¿›è¡Œé€šä¿¡ï¼Œä»è€Œå®ç°ä¸æ‰©å±•ç¨‹åºçš„äº¤äº’ã€‚

**æ‰§è¡Œé¡µé¢è„šæœ¬**ï¼šcontent script å¯ä»¥åœ¨åŒ¹é…åˆ°çš„é¡µé¢ä¸­æ‰§è¡Œ JavaScript ä»£ç ï¼Œä»è€Œå®ç°æ›´å¤æ‚çš„æ“ä½œå’Œäº¤äº’ã€‚

**æ“ä½œæµè§ˆå™¨æ ‡ç­¾é¡µ**ï¼šcontent script å¯ä»¥é€šè¿‡ chrome.tabs API æ“ä½œæµè§ˆå™¨æ ‡ç­¾é¡µï¼Œä¾‹å¦‚åˆ‡æ¢æ ‡ç­¾é¡µã€æ‰“å¼€æ–°æ ‡ç­¾é¡µã€å…³é—­æ ‡ç­¾é¡µç­‰ã€‚

### é…ç½®

content_scripts çš„ç›¸å…³é€»è¾‘æ–‡ä»¶éœ€è¦åœ¨ manifest.json ä¸­é€šè¿‡é…ç½®æŒ‡å®šï¼

```js
{
  "manifest_version": 3,
  // ...
  "content_scripts": [
    {
      "matches": ["https://www.example.com/*"],
      "js": ["content/content_script.js"],
      "css": ["content/styles.css"]
    }
  ]
}
```

**js å±æ€§ï¼š** ç”¨äºæŒ‡å®šè¦æ³¨å…¥çš„ JavaScript æ–‡ä»¶åˆ—è¡¨ï¼Œå³åœ¨åŒ¹é…åˆ°çš„ç½‘é¡µä¸­ï¼Œä¼šå°†æŒ‡å®šçš„ JavaScript æ–‡ä»¶æ³¨å…¥åˆ°ç½‘é¡µä¸­ï¼Œä»è€Œå®ç°å¯¹ç½‘é¡µé€»è¾‘çš„ä¿®æ”¹å’Œå¢å¼ºã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥åŒ…å«å¤šä¸ª JavaScript æ–‡ä»¶è·¯å¾„ã€‚æ¯ä¸ªè·¯å¾„éƒ½æ˜¯ç›¸å¯¹äºæ‰©å±•ç¨‹åºæ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚

**css å±æ€§ï¼š** ç”¨äºæŒ‡å®šè¦æ³¨å…¥çš„ CSS æ–‡ä»¶åˆ—è¡¨ï¼Œå³åœ¨åŒ¹é…åˆ°çš„ç½‘é¡µä¸­ï¼Œä¼šå°†æŒ‡å®šçš„ CSS æ–‡ä»¶æ³¨å…¥åˆ°ç½‘é¡µä¸­ï¼Œä»è€Œå®ç°å¯¹ç½‘é¡µæ ·å¼çš„ä¿®æ”¹å’Œå¢å¼ºã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥åŒ…å«å¤šä¸ª CSS æ–‡ä»¶è·¯å¾„ã€‚æ¯ä¸ªè·¯å¾„éƒ½æ˜¯ç›¸å¯¹äºæ‰©å±•ç¨‹åºæ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚

**ğŸ“ Hintï¼šCSS æ–‡ä»¶ä¼šè‡ªåŠ¨æ³¨å…¥åˆ°åŒ¹é…çš„ç½‘é¡µä¸­ï¼Œæ— éœ€åœ¨ JavaScript é€»è¾‘ä¸­å£°æ˜ã€‚**

**matches å±æ€§ï¼š** ç”¨äºæŒ‡å®šè¦æ³¨å…¥è„šæœ¬å’Œæ ·å¼çš„ç½‘é¡µ URL åŒ¹é…æ¨¡å¼ï¼Œå³åªæœ‰åŒ¹é…æŒ‡å®š URL æ¨¡å¼çš„ç½‘é¡µæ‰ä¼šæ³¨å…¥ç›¸åº”çš„è„šæœ¬å’Œæ ·å¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œmatches å±æ€§æ˜¯å¿…éœ€çš„ï¼Œå¦‚æœæœªæŒ‡å®šè¯¥å±æ€§ï¼Œåˆ™ content_scripts ä¸ä¼šç”Ÿæ•ˆã€‚

æ¯ä¸ª URL æ¨¡å¼éƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ ` * ` åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œä¾‹å¦‚ï¼š

ğŸ“Œ `https://www.example.com/*` åŒ¹é… `https://www.example.com/` åŠå…¶å­è·¯å¾„ä¸‹çš„æ‰€æœ‰ç½‘é¡µã€‚

ğŸ“Œ `http://*.example.com` åŒ¹é…ä»¥ `http://` å¼€å¤´ã€ä»¥ `.example.com` ç»“å°¾çš„æ‰€æœ‰ç½‘é¡µã€‚

ğŸ“Œ `https://www.example.com/page.html` åŒ¹é…æŒ‡å®šçš„ç½‘é¡µã€‚

**ğŸ“ Hint:** matches çš„è¯¦ç»†åŒ¹é…è§„åˆ™å¯ä»¥å‚è€ƒ [Match Patterns - Google Chrome](https://developer.chrome.com/docs/extensions/mv3/match_patterns/)


**å®Œæ•´çš„ content_scripts é…ç½®å¯å‚è€ƒ [Documentation > Extensions > In depth: core concepts | Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/)**


### é™åˆ¶

åœ¨ content script ä¸­ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ Service Workerï¼ˆSWï¼‰APIï¼Œå› ä¸º Service Worker æ˜¯åœ¨åå°æœåŠ¡å·¥ä½œçº¿ç¨‹ä¸­è¿è¡Œçš„ã€‚

content script è¿è¡Œåœ¨ Web é¡µé¢çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå®ƒä»¬ä¸èƒ½ç›´æ¥è®¿é—®æµè§ˆå™¨çš„åå°æœåŠ¡å·¥ä½œçº¿ç¨‹ã€‚ç›¸åï¼Œcontent script åªèƒ½è®¿é—®ä¸€ä¸ªå—é™çš„ subset APIã€‚

å¦‚æœä½ éœ€è¦ä½¿ç”¨ Service Worker APIï¼Œä½ å¯ä»¥åœ¨åå°æœåŠ¡å·¥ä½œçº¿ç¨‹ä¸­æ³¨å†Œ Service Workerï¼Œå¹¶åœ¨ Service Worker ä¸­å¤„ç†ç›¸å…³çš„äº‹ä»¶ã€‚ç„¶åä½¿ç”¨ chrome.runtime.sendMessage() æ–¹æ³•å‘åå°æœåŠ¡å·¥ä½œçº¿ç¨‹å‘é€æ¶ˆæ¯ï¼Œä»¥ä¾¿ content script ä¸ Service Worker è¿›è¡Œé€šä¿¡ã€‚


## Background Script

background ç”¨äºæŒ‡å®šåå°è„šæœ¬æˆ–è€…åå°æœåŠ¡å·¥ä½œçº¿ç¨‹ã€‚æœ¬èŠ‚è¦

å®ƒåœ¨æµè§ˆå™¨æ‰©å±•ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œå¸¸ç”¨äºå¤„ç†æ‰©å±•çš„æ ¸å¿ƒåŠŸèƒ½ã€å“åº”æµè§ˆå™¨äº‹ä»¶ã€ä¸å…¶ä»–é¡µé¢é€šä¿¡ç­‰ï¼›

ğŸ“Œ **å¤„ç†æ‰©å±•çš„æ ¸å¿ƒåŠŸèƒ½ï¼š** ä½œä¸ºæ‰©å±•çš„ä¸­å¤®æ§åˆ¶å™¨ï¼Œå¤„ç†æ‰©å±•çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä¾‹å¦‚æ•°æ®å­˜å‚¨ã€ç½‘ç»œè¯·æ±‚ã€æ•°æ®åŒæ­¥ç­‰ï¼›

ğŸ“Œ **å“åº”æµè§ˆå™¨äº‹ä»¶ï¼š** å“åº”æµè§ˆå™¨äº‹ä»¶ï¼Œä¾‹å¦‚ç›‘å¬æµè§ˆå™¨æ ‡ç­¾é¡µçš„åˆ›å»ºã€æ›´æ–°ã€å…³é—­ç­‰äº‹ä»¶ï¼Œä»¥å®ç°ç›¸å…³åŠŸèƒ½ï¼›

ğŸ“Œ **ä¸å…¶ä»–é¡µé¢é€šä¿¡ï¼š** ä¸æ‰©å±•ä¸­çš„å…¶ä»–é¡µé¢ï¼ˆä¾‹å¦‚ popupã€options é¡µé¢ï¼‰è¿›è¡Œé€šä¿¡ï¼Œä»¥ä¾¿å®ç°é¡µé¢ä¹‹é—´çš„æ•°æ®å…±äº«ã€çŠ¶æ€åŒæ­¥ç­‰ï¼›

åœ¨æ‰©å±•ç¨‹åºä¸­ï¼Œcontent_scriptã€popupä»¥åŠoptionsä¸‰ä¸ªéƒ¨åˆ†éƒ½æ˜¯å¯ä»¥æ‰§è¡Œè„šæœ¬çš„ã€‚å®ƒä»¬ç›¸äº’ä¹‹é—´éƒ½æ˜¯ä¸èƒ½ç›´æ¥é€šä¿¡çš„ã€‚background çš„Server Workersåˆ™å¯ä»¥èµ·åˆ°äº‹ä»¶ä¸­å¿ƒçš„ä½œç”¨ï¼Œç»™ä»–ä»¬æ´¾å‘äº‹ä»¶å’Œæ¶ˆæ¯ï¼å¦å¤–ï¼Œå®ƒä»¬ä¸‰è€…éƒ½ä¸èƒ½è°ƒç”¨å®Œæ•´çš„ Chrome Apisï¼Œä»…èƒ½ä½¿ç”¨ä¸€ä¸ªå­é›† Apiï¼Œä½†æ˜¯ background å¯ä»¥ï¼é‚£ä¹ˆå®ƒä»¬ä¸‰è€…åˆ™å¯ä»¥é€šè¿‡æ¶ˆæ¯é€šä¿¡è®¿é—® backgroundï¼Œä»è€Œè°ƒç”¨å®Œæ•´çš„ Chrome Apisã€‚

ğŸ“Œ **å¤„ç†åå°ä»»åŠ¡ï¼š** åœ¨åå°è¿è¡Œï¼Œå¤„ç†åå°ä»»åŠ¡ï¼Œä¾‹å¦‚å®šæœŸæ£€æŸ¥æ•°æ®æ›´æ–°ã€å‘é€æ¨é€æ¶ˆæ¯ç­‰ï¼›

ğŸ“Œ **æ‰©å±•çš„åˆå§‹åŒ–ï¼š** ä½œä¸ºæ‰©å±•çš„åˆå§‹åŒ–å…¥å£ï¼Œå¯åŠ¨æ‰©å±•æ—¶é¢„åŠ è½½ä¸€äº›èµ„æºã€åˆå§‹åŒ–ä¸€äº›çŠ¶æ€ç­‰ã€‚


### é…ç½®

background é€šè¿‡ manifesté…ç½®ï¼Œæ¶‰åŠåˆ° `service_worker` å’Œ `persistent` ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š

```json
{
  "manifest_version": 3,
  "name": "My Extension",
  "background": {
    "service_worker": "background.js",
    "persistent": true
  }
}
```

**`service_worker`å±æ€§ï¼š** é…ç½®æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶ä½ç½®ï¼› 


**`persistent`å±æ€§ï¼š** æ˜¯ä¸€ä¸ªå¯é€‰çš„å¸ƒå°”ç±»å‹çš„å­—æ®µï¼Œç”¨äºæŒ‡ç¤ºåå°è„šæœ¬æˆ–è€…åå°æœåŠ¡å·¥ä½œçº¿ç¨‹çš„æŒç»­æ€§ã€‚

ğŸ‘‰ `persistent: true`ï¼Œè¡¨ç¤ºåå°è„šæœ¬æˆ–è€…åå°æœåŠ¡å·¥ä½œçº¿ç¨‹æ˜¯æŒç»­æ€§çš„ï¼Œä¼šä¸€ç›´è¿è¡Œï¼Œç›´åˆ°æµè§ˆå™¨å…³é—­æˆ–è€…æ‰©å±•è¢«å¸è½½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåå°è„šæœ¬æˆ–è€…åå°æœåŠ¡å·¥ä½œçº¿ç¨‹å¯ä»¥éšæ—¶å“åº”äº‹ä»¶ã€å¤„ç†ä»»åŠ¡ï¼Œè€Œä¸éœ€è¦é‡æ–°å¯åŠ¨ã€‚

**ğŸ“ Hint**ï¼šåœ¨ persistent: true æ¨¡å¼ä¸‹ï¼Œåå°æœåŠ¡å·¥ä½œçº¿ç¨‹ç‹¬ç«‹äºä»»ä½•æ‰©å±•æ“ä½œçª—å£æˆ–æ ‡ç­¾é¡µè¿è¡Œï¼Œå¹¶ä¸”ä¼šä¸€ç›´è¿è¡Œï¼Œç›´åˆ°ç”¨æˆ·å…³é—­æ‰©å±•æˆ–æµè§ˆå™¨ã€‚å³ä½¿ç”¨æˆ·å…³é—­äº†æ‰©å±•æ“ä½œçª—å£æˆ–æ ‡ç­¾é¡µï¼Œåå°æœåŠ¡å·¥ä½œçº¿ç¨‹ä»ä¼šç»§ç»­è¿è¡Œã€‚


ğŸ‘‰ `persistent: false`ï¼Œè¡¨ç¤ºåå°è„šæœ¬æˆ–è€…åå°æœåŠ¡å·¥ä½œçº¿ç¨‹åªåœ¨éœ€è¦æ—¶è¢«åŠ è½½å’Œæ‰§è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåå°è„šæœ¬æˆ–è€…åå°æœåŠ¡å·¥ä½œçº¿ç¨‹åªæœ‰åœ¨éœ€è¦å¤„ç†äº‹ä»¶æˆ–è€…ä»»åŠ¡æ—¶æ‰ä¼šè¢«å¯åŠ¨ï¼Œå¹¶åœ¨å®Œæˆä»»åŠ¡åè‡ªåŠ¨å…³é—­ã€‚

**ğŸ“ Hint**ï¼šå½“åœ¨ manifest.json æ–‡ä»¶ä¸­è®¾ç½® persistent: false æ—¶ï¼Œåå°æœåŠ¡å·¥ä½œçº¿ç¨‹ä¼šåœ¨æ‰€æœ‰æ‰©å±•æ“ä½œçª—å£å’Œæ ‡ç­¾é¡µå…³é—­åè‡ªåŠ¨å…³é—­ã€‚æ­¤æ—¶ï¼Œåå°æœåŠ¡å·¥ä½œçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¸æ‰©å±•æ“ä½œçª—å£å’Œæ ‡ç­¾é¡µçš„ç”Ÿå‘½å‘¨æœŸç›¸åŒã€‚

å…·ä½“æ¥è¯´ï¼Œåå°æœåŠ¡å·¥ä½œçº¿ç¨‹ä¼šåœ¨æ‰€æœ‰æ‰©å±•æ“ä½œçª—å£å’Œæ ‡ç­¾é¡µå…³é—­åçš„ä¸€æ®µæ—¶é—´å†…ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼Œä»¥ä¾¿å¤„ç†æœªå®Œæˆçš„ä»»åŠ¡ã€‚åœ¨è¿™æ®µæ—¶é—´è¿‡åï¼Œåå°æœåŠ¡å·¥ä½œçº¿ç¨‹ä¼šè¢«ç»ˆæ­¢ã€‚å¦‚æœåå°æœåŠ¡å·¥ä½œçº¿ç¨‹éœ€è¦åœ¨å…³é—­å‰æ‰§è¡Œä¸€äº›æ¸…ç†æ“ä½œï¼Œä¾‹å¦‚ä¿å­˜æ•°æ®æˆ–å…³é—­ç½‘ç»œè¿æ¥ï¼Œå¯ä»¥åœ¨ chrome.runtime.onSuspend äº‹ä»¶ä¸­æ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚


### åŒºåˆ†æ‰©å±•ç¨‹åºçš„ service workers å’Œç½‘é¡µçš„ service workers

é¦–å…ˆè¦æ˜ç¡®ä¸¤è€…ä¸æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œåœ¨æ¦‚å¿µä¸Šæ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯ä»–ä»¬çš„åº”ç”¨ã€apiç­‰éƒ½ç•¥æœ‰ä¸åŒï¼

æ‰©å±•ç¨‹åº service workers å’Œ ç½‘é¡µçš„ service workers éƒ½æ˜¯åœ¨åå°è¿è¡Œå¹¶å¤„ç†äº‹ä»¶é©±åŠ¨ä»»åŠ¡çš„ JavaScript æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬ä¹‹é—´å­˜åœ¨ä¸€äº›ä¸åŒä¹‹å¤„ï¼š

ğŸ“Œ **ä¸Šä¸‹æ–‡**ï¼šæ‰©å±•ç¨‹åº service workers åœ¨æµè§ˆå™¨æ‰©å±•çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œï¼Œè€Œç½‘é¡µçš„ service workers åœ¨ç½‘é¡µçš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œã€‚

ğŸ“Œ **èŒƒå›´**ï¼šæ‰©å±•ç¨‹åº service workers çš„èŒƒå›´ä»…é™äºæ‰€å±çš„æ‰©å±•ç¨‹åºï¼Œè€Œç½‘é¡µçš„ service workers çš„èŒƒå›´ä»…é™äºæ³¨å†Œå®ƒä»¬çš„ç½‘ç«™ã€‚

ğŸ“Œ **æƒé™**ï¼šæ‰©å±•ç¨‹åº service workers å¯ä»¥è®¿é—®ç½‘é¡µçš„ service workers æ— æ³•è®¿é—®çš„å…¶ä»–æƒé™ï¼Œä¾‹å¦‚ä¿®æ”¹æµè§ˆå™¨è®¾ç½®ã€è®¿é—®ç”¨æˆ·æ•°æ®å’Œä¸å…¶ä»–æ‰©å±•ç¨‹åºäº¤äº’ç­‰ã€‚

ğŸ“Œ **é€šä¿¡**ï¼šæ‰©å±•ç¨‹åº service workers å¯ä»¥ä¸æ‰©å±•ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ï¼ˆä¾‹å¦‚å†…å®¹è„šæœ¬å’Œåå°é¡µé¢ï¼‰è¿›è¡Œé€šä¿¡ï¼Œè€Œç½‘é¡µçš„ service workers åªèƒ½ä¸æ³¨å†Œå®ƒä»¬çš„ç½‘é¡µè¿›è¡Œé€šä¿¡ã€‚

```js
// æ‰©å±•ç¨‹åº service workers çš„æ¶ˆæ¯é€šä¿¡
const response = await chrome.tabs.sendMessage(tab.id, {greeting: "hello"});

chrome.runtime.onMessage.addListener(
  function(request, sender, sendResponse) {
    console.log(sender.tab ?
                "from a content script:" + sender.tab.url :
                "from the extension");
    if (request.greeting === "hello")
      sendResponse({farewell: "goodbye"});
  }
);

// ç½‘é¡µçš„ service workersæ¶ˆæ¯é€šä¿¡

client.postMessage({
  msg: "Hey I just got a fetch from you!",
  url: event.request.url,
});

navigator.serviceWorker.addEventListener("message", (event) => {
  console.log(event.data.msg, event.data.url);
});
```

ğŸ“Œ **æ¿€æ´»**ï¼šå®‰è£…æ‰©å±•ç¨‹åºæ—¶æ‰©å±•ç¨‹åº service workers ä¼šè‡ªåŠ¨æ¿€æ´»ï¼Œè€Œç½‘é¡µçš„ service workers éœ€è¦ç”±ç½‘ç«™å¼€å‘äººå‘˜æ‰‹åŠ¨æ³¨å†Œã€‚

æ€»ä¹‹ï¼Œæ‰©å±•ç¨‹åºæœåŠ¡å·¥ä½œè€…æ—¨åœ¨ä¸ºæµè§ˆå™¨æ‰©å±•æä¾›é¢å¤–çš„åŠŸèƒ½ï¼Œè€Œ Web æœåŠ¡å·¥ä½œè€…æ—¨åœ¨ä¸ºç½‘é¡µæä¾›ç¦»çº¿æ”¯æŒå’Œå…¶ä»–åŠŸèƒ½ã€‚



## Popup Dasboard

popup æ˜¯æŒ‡æµè§ˆå™¨æ‰©å±•ä¸­çš„ä¸€ä¸ªç‰¹æ®Šé¡µé¢ï¼Œç”¨äºåœ¨å·¦é”®å•å‡»æµè§ˆå™¨æ‰©å±•å›¾æ ‡æ—¶æ˜¾ç¤ºçš„å¼¹å‡ºçª—å£ä¸­æ˜¾ç¤ºå†…å®¹ã€‚popup é¡µé¢å¯ä»¥åŒ…å« HTMLã€CSS å’Œ JavaScript ç­‰å†…å®¹ï¼Œå¯ä»¥å®ç°å„ç§åŠŸèƒ½ï¼Œä¾‹å¦‚æ˜¾ç¤ºæ‰©å±•ç¨‹åºçš„è®¾ç½®ã€è°ƒç”¨æµè§ˆå™¨æ‰©å±• API è¿›è¡Œæ“ä½œã€ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ç­‰ã€‚

Popup çš„å°ºå¯¸æ—¶æœ‰é™åˆ¶çš„ã€‚ä¸èƒ½å°äº 25x25ï¼Œä¸èƒ½å¤§äº 800x600ã€‚

|![](./%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%A9%E5%B1%95%E7%A8%8B%E5%BA%8F/Snipaste_2023-06-08_12-29-52.png)|
|:--:|

popup ä¹Ÿæ˜¯éœ€è¦é€šè¿‡ manifest é…ç½®æŒ‡å®šï¼

```json
{
  "manifest_version": 3,
  // ...
  "action": {
    "default_popup": "popup.html"
  }
}
```

æ³¨æ„ï¼åœ¨ manifestä¸­ï¼Œpopup æŒ‡å®šçš„æ˜¯ä¸€ä¸ªhtmlæ–‡ä»¶ï¼

popupä¹Ÿæ˜¯å¯ä»¥å¼•å…¥ JS å’Œ CSSã€‚ä½†æ˜¯å’Œ content_script ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸éœ€è¦åœ¨ manifest ä¸­æŒ‡å®šã€‚ éœ€è¦åœ¨HTMLæ–‡ä»¶ä¸­ä½¿ç”¨ `<script>` å’Œ `<link>` æ ‡ç­¾å¼•å…¥ JavaScript å’Œ CSS æ–‡ä»¶ã€‚å¯ä»¥è®¤ä¸ºpopupæ˜¯å•ç‹¬çš„å°é¡µé¢ï¼

```html
<!DOCTYPE html>
<html>
  <head>
    <title>My Extension Popup</title>
    <script src="popup.js"></script>
    <link rel="stylesheet" href="popup.css">
  </head>
  <body>
    <h1>Hello, World!</h1>
    <button id="my-button">Click me!</button>
  </body>
</html>
```

popup ä¸­å¼•å…¥çš„ JavaScript æ–‡ä»¶è¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„æ²™ç›’ç¯å¢ƒä¸­ï¼Œå®ƒå¯ä»¥è®¿é—®æµè§ˆå™¨æ‰©å±• APIï¼Œä½†éœ€è¦æ³¨æ„å®ƒä¸æµè§ˆå™¨æ‰©å±•çš„å…¶ä»–éƒ¨åˆ†ï¼ˆå¦‚ background è„šæœ¬ï¼‰æ˜¯éš”ç¦»çš„ã€‚

å¦å¤–ï¼Œç”±äº popup æ˜¾ç¤ºæ—¶é—´é€šå¸¸è¾ƒçŸ­ï¼Œå› æ­¤åœ¨ JavaScript æ–‡ä»¶ä¸­éœ€è¦å°½é‡é¿å…ä½¿ç”¨é•¿æ—¶é—´è¿è¡Œçš„æ“ä½œï¼Œä»¥å…å½±å“ç”¨æˆ·ä½“éªŒã€‚ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦è¿›è¡Œä¸€äº›è¾ƒä¸ºè€—æ—¶çš„è®¡ç®—ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ Web Worker æ¥å°†è®¡ç®—è¿‡ç¨‹è½¬ç§»åˆ°åå°çº¿ç¨‹ä¸­ï¼Œä»¥å…é˜»å¡ä¸»çº¿ç¨‹ã€‚


**Hint**ï¼šPopupçš„è¯¦ç»†ä½¿ç”¨ä¸é…ç½®å¯å‚è€ƒ [Documentation > Extensions > API reference | Popup](https://developer.chrome.com/docs/extensions/reference/action/#popup)


## Options Page

|![Options Page](./%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%A9%E5%B1%95%E7%A8%8B%E5%BA%8F/Snipaste_2023-06-08_15-51-31.png)|
|:--:|

åœ¨æµè§ˆå™¨æ‰©å±•ç¨‹åºä¸­ï¼ŒOptions é¡µé¢æä¾›äº†ä¸€ä¸ªç”¨æˆ·ç•Œé¢ï¼Œå…è®¸ç”¨æˆ·é…ç½®æ‰©å±•ç¨‹åºçš„è®¾ç½®å’Œé€‰é¡¹ã€‚é€šè¿‡ Options é¡µé¢ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æ‰©å±•ç¨‹åºçš„è¡Œä¸ºå’Œå¤–è§‚ï¼Œä»¥æ»¡è¶³ä»–ä»¬çš„éœ€æ±‚å’Œåå¥½ã€‚æ¯”å¦‚å¯ä»¥ç”¨äºä½†ä¸é™äºä»¥ä¸‹ç”¨é€”ï¼š

ğŸ“Œ **é…ç½®é€‰é¡¹**ï¼šå…è®¸ç”¨æˆ·é…ç½®æ‰©å±•ç¨‹åºçš„é€‰é¡¹å’Œè®¾ç½®ï¼Œä¾‹å¦‚è¯­è¨€ã€ä¸»é¢˜ã€å­—ä½“å¤§å°ã€é¢œè‰²ç­‰ï¼Œå½“ç„¶å‰ææ˜¯æ‰©å±•ç¨‹åºæœ‰æš´éœ²è¿™äº›è®¾ç½®ï¼›

ğŸ“Œ **æ˜¾ç¤ºå¸®åŠ©å’Œæ–‡æ¡£**ï¼šæä¾›å¸®åŠ©å’Œæ–‡æ¡£ï¼Œå¸®åŠ©ç”¨æˆ·äº†è§£æ‰©å±•ç¨‹åºçš„åŠŸèƒ½å’Œç”¨æ³•ï¼›

ğŸ“Œ **æ”¶é›†åé¦ˆå’Œå»ºè®®**ï¼šæä¾›åé¦ˆå’Œå»ºè®®çš„è¡¨å•ï¼Œå…è®¸ç”¨æˆ·å‘å¼€å‘è€…åé¦ˆä»–ä»¬å¯¹æ‰©å±•ç¨‹åºçš„çœ‹æ³•å’Œå»ºè®®ï¼›

ğŸ“Œ **æ˜¾ç¤ºå…³äºä¿¡æ¯**ï¼šæ˜¾ç¤ºæœ‰å…³æ‰©å±•ç¨‹åºçš„ä¿¡æ¯ï¼Œä¾‹å¦‚ç‰ˆæœ¬å·ã€ä½œè€…ã€è®¸å¯è¯ç­‰ï¼›

Options Page æ˜¯ç‚¹å‡»æ‰©å±•ç¨‹åºå›¾ç‰‡å³é”® > ç‚¹å‡» â€œOptionsâ€ è·³è½¬æˆ–å¼¹å‡ºçš„é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢é…ç½®æ˜¯å¯é€‰çš„ï¼

ä¸ Popup Dashboardä¸€æ ·ï¼Œå®ƒä¹Ÿå¯ä»¥åŒ…å« HTMLã€CSS å’Œ JavaScript ç­‰å†…å®¹ã€‚

### é…ç½®

Options Pageæœ‰ä¸¤ç§ç±»å‹ï¼Œæ•´é¡µå’ŒåµŒå…¥å¼ï¼Œé€‰é¡¹é¡µé¢çš„ç±»å‹å–å†³äºå®ƒåœ¨æ¸…å•ä¸­çš„å£°æ˜æ–¹å¼ã€‚

#### æ•´é¡µ

æ•´é¡µçš„Options Pageåœ¨ç”¨æˆ·ç‚¹å‡»â€œOptionsâ€æŒ‰é’®æ—¶ä¼šè·³è½¬é¡µé¢ï¼Œé…ç½®å¦‚ä¸‹ï¼š

```json
{
  "name": "My extension",
  ...
  "options_page": "options.html",
  ...
}
```

#### åµŒå…¥å¼

ä¸æ•´é¡µä¸åŒï¼Œå®ƒå…è®¸ç›´æ¥åœ¨â€œ[æ‰©å±•ç¨‹åºç®¡ç†é¡µé¢](edge://extensions/)â€ï¼ˆä¸æ˜¯æ‰©å±•ç¨‹åºåŒ¹é…åˆ°çš„é¡µé¢ï¼‰å¼¹å‡ºï¼

|![](./%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%A9%E5%B1%95%E7%A8%8B%E5%BA%8F/Snipaste_2023-06-08_15-51-31.png)|
|:--:|

```json
{
  "name": "My extension",
  ...
  "options_ui": {
    "page": "options.html",
    "open_in_tab": false
  },
  ...
}
```
**`page` (string)**

é…ç½® options é¡µé¢çš„æ–‡ä»¶è·¯å¾„ã€‚

**`open_in_tab` (boolean)**

`true`ï¼šåœ¨ [æ‰©å±•ç¨‹åºç®¡ç†é¡µé¢](edge://extensions/) å¼¹å‡ºï¼›

`false`ï¼šæ–°æ ‡ç­¾æ‰“å¼€ options é¡µé¢ã€‚


## Extension Icons

icons æ˜¯æµè§ˆå™¨æ‰©å±•æ‰€éœ€è¦çš„å›¾æ ‡æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸åŒå°ºå¯¸çš„å›¾æ ‡ï¼Œä¾‹å¦‚ icon16.pngã€icon32.pngã€icon48.png å’Œ icon128.png ç­‰ã€‚

è¿™äº›å›¾æ ‡æ–‡ä»¶ä¼šåœ¨æµè§ˆå™¨æ‰©å±•è¢«å®‰è£…æ—¶æ˜¾ç¤ºåœ¨æµè§ˆå™¨çš„åœ°å€æ ã€ä¹¦ç­¾æ ã€å·¥å…·æ ç­‰ä½ç½®ï¼Œä»¥åŠåœ¨æ’ä»¶å•†åº—ä¸­å±•ç¤ºã€‚

ä¸åŒæµè§ˆå™¨çš„å›¾æ ‡å°ºå¯¸è¦æ±‚å¯èƒ½ç•¥æœ‰ä¸åŒï¼Œå› æ­¤éœ€è¦æŒ‰ç…§ç›¸åº”çš„è¦æ±‚æä¾›ä¸åŒå°ºå¯¸çš„å›¾æ ‡æ–‡ä»¶ï¼Œä»¥ä¿è¯æ‰©å±•åœ¨å„ç§æƒ…å†µä¸‹éƒ½èƒ½å¤Ÿæ­£ç¡®æ˜¾ç¤ºã€‚å¸¸è§çš„å°ºå¯¸åŒ…æ‹¬16x16ã€32x32ã€48x48 å’Œ 128x128 ç­‰ã€‚

ä¸‹é¢æ˜¯iconsé…ç½®çš„ç®€å•ä¾‹å­ï¼š

```json
{
  "manifest_version": 3,
  "name": "My Extension",
  "version": "1.0.0",
  "icons": {
    "16": "icons/icon16.png",
    "32": "icons/icon32.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  }
}
```

**ğŸ“ Hint:** icons å…è®¸ä»¥æ•°ç»„å½¢å¼é…ç½®ï¼


# è°ƒè¯•

åœ¨è°ƒè¯•ä½ çš„æ‰©å±•ç¨‹åºå‰ï¼Œéœ€è¦å…ˆç¡®è®¤é¡¹ç›®æ˜¯å®Œæ•´çš„ï¼Œæœ€å°‘è¦åŒ…å«ä¸€ä¸ª `manifest.json` æ–‡ä»¶ã€‚

å¦‚æœä½¿ç”¨äº†content_scriptsã€popupæˆ–optionï¼Œå°±è¦ä¿è¯å®ƒä»¬çš„è·¯å¾„è¢«æ­£ç¡®é…ç½®åœ¨ `manifest.json` ä¸­ã€‚å¦‚æœ content_scripts æ²¡æœ‰ç”Ÿæ•ˆï¼Œåˆ™éœ€è¦ç•™æ„ mathchs å±æ€§æ˜¯å¦æ­£ç¡®é…ç½®ï¼›

ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨å¼€å‘è€…æ¨¡å¼åŠ è½½ä½ çš„æœ¬åœ°é¡¹ç›®è¿›è¡Œè°ƒè¯•ï¼


1ï¸âƒ£ åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ `chrome://extensions`ï¼Œè·³è½¬åˆ° æ‰©å±•ç¨‹åºç®¡ç†é¡µé¢

2ï¸âƒ£ ç‚¹å‡» `Developer mode` æ—è¾¹çš„åˆ‡æ¢å¼€å…³å¯ç”¨å¼€å‘äººå‘˜æ¨¡å¼ï¼›

3ï¸âƒ£ ç‚¹å‡» `Load unpacked` æŒ‰é’®ï¼Œå¹¶é€‰æ‹©ä½ å¼€å‘çš„æ‰©å±•ç¨‹åºå³å¯ã€‚

|![](./%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%A9%E5%B1%95%E7%A8%8B%E5%BA%8F/BzVElZpUtNE4dueVPSp3.webp)|
|:--:|


ä»£ç ä¸­çš„consoleä¼šåœ¨æµè§ˆå™¨çš„ Console Tab è¾“å‡ºï¼›

é”™è¯¯æ—¥å¿—ï¼Œæ‰©å±•ç¨‹åºå¡ç‰‡ä¸Šä¼šæœ‰â€œErrorâ€æŒ‰é’®ï¼Œç‚¹å‡»å¯ä»¥æŸ¥çœ‹é”™è¯¯æ—¥å¿—

- vscodeæ‰©å±•ï¼Œæ–¹ä¾¿å¼€å‘chromeæ‰©å±•ï¼šaaravb.chrome-extension-developer-tools

å‚è€ƒï¼š
- https://developer.chrome.com/docs/extensions/mv3/getstarted/development-basics/
- [Debugging extensions](https://developer.chrome.com/docs/extensions/mv3/tut_debugging/)


# å‘å¸ƒ

ä¸‹é¢å°†ä»‹ç»å¦‚æœå°†æ‰©å±•ç¨‹åºå‘å¸ƒåˆ°Chromeæ‰©å±•ç¨‹åºå•†åº—ã€‚

å‘å¸ƒå‰éœ€è¦å…ˆæ³¨å†Œä¸€ä¸ªå¼€å‘è€…è´¦å·ï¼Œç„¶åå†æ‰“åŒ…é¡¹ç›®ä»£ç ï¼Œæœ€åå°±å¯ä»¥åœ¨å¼€å‘è€…è´¦å·çš„ä¸Šä¼ é¡µä¸Šä¼ ï¼

ğŸ“ Hintï¼šæ³¨å†Œæˆä¸ºå¼€å‘è€…éœ€è¦æ”¯ä»˜æ³¨å†Œè´¹ï¼ˆç›®å‰äº†è§£åˆ°çš„æƒ…å†µæ˜¯éœ€è¦5åˆ€ï¼‰


## æ‰“åŒ…

éœ€è¦å°†é¡¹ç›®ä»£ç æ‰“åŒ…æˆ zip åŒ…ï¼zip åŒ…å¿…é¡»åŒ…å«mainfestæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¿…é¡»åŒ…å«nameã€versionã€iconså’Œdescriptionå››ä¸ªå±æ€§ï¼

å‚è€ƒï¼š[Publish in the Chrome Web Store]













[Chrome APIs]:https://developer.chrome.com/docs/extensions/reference/


[Manifest file format]: https://developer.chrome.com/docs/extensions/mv3/manifest/

[æ‰©å±•ä¾‹å­ä»£ç ]:https://github.com/GoogleChrome/chrome-extensions-samples/tree/main/functional-samples/tutorial.hello-world

[Match Patterns]:https://developer.chrome.com/docs/extensions/mv3/match_patterns/

[Publish in the Chrome Web Store]:https://developer.chrome.com/docs/webstore/publish/

[Chrome Webå•†åº—]:https://chrome.google.com/webstore

[Firefox å•†åº—]:poe://www.poe.com/_api/key_phrase?phrase=Firefox&prompt=Tell%20me%20more%20about%20Firefox

[Mozilla Add-ons]:https://addons.mozilla.org/

[Safariæ‰©å±•ç¨‹åºåº“]:https://extensions.apple.com/

[Microsoft Edge Add-ons]:https://microsoftedge.microsoft.com/addons
